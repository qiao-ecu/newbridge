define(function(require){function e(e){r.apply(this,arguments)}var t=require("etpl"),n=require("jquery"),i=require("esui/lib"),r=require("./MessageBase"),a=require("common/util/fileManager"),o=require("common/config");return e.prototype.renderText=function(){return t.render("textMessage",this.data)},e.prototype.processImg=function(){n("img[data-bcsname]",this.main).each(function(e,t){t=n(t);var i=t.attr("data-bcsname"),r=t.attr("data-uploaded")-0;if(0===r)t.attr("src",o.loadingImgPath);else if(1===r){var s=a.getFilePathByBcsName(i);if(s="../../"+s,a.exist(i))t.attr("src",s);else t.attr("src",o.loadingImgPath),a.download(i).then(function(){t.attr("src",s)},function(){t.attr("src",o.failImgPath)})}else if(2===r)t.attr("src",o.failImgPath)})},e.prototype.render=function(){return r.prototype.render.apply(this,arguments),this.processImg(),this.main},i.inherits(e,r),e});