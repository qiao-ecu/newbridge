define(function(require){function e(e){i.apply(this,arguments)}var t=(require("underscore"),require("esui/lib")),n=require("esui/Control"),i=require("esui/Button"),r=(require("esui/painters"),{});return e.prototype={type:"Icon",createMain:function(e){var t=document.createElement("div");if(e.className)t.className=e.className;return t},initOptions:function(){i.prototype.initOptions.apply(this,arguments),this.max=this.max||1/0,this.notification=this.notification||0},initStructure:function(){i.prototype.initStructure.apply(this,arguments);var e=document.createElement("div");this.textWrapper=e,e.innerHTML=this.main.innerHTML,this.main.innerHTML="",this.helper.addPartClasses("text",e),this.main.appendChild(e)},initEvents:function(){i.prototype.initEvents.apply(this,arguments);var e=this;this.on("click",function(){var t=window.require,n=t("nw.gui");if(e.url){var i={focus:!0,position:"center"};if(e.windowWidth)i.width=e.windowWidth;if(e.windowHeight)i.height=e.windowHeight;if(e.injectJsStart)i["inject-js-start"]=e.injectJsStart;var a,o=!1;try{if(a=r[e.id],a&&a.window)o=!0}catch(s){}if(o)a.window.focus();else a=n.Window.open(e.url,i),r[e.id]=a,e.fire("startload",a),a.on("loaded",function(){e.fire("loaded",a)})}e.updateNotify(0)})},repaint:require("esui/painters").createRepaint(n.prototype.repaint,{name:["content"],paint:function(e,t){e.textWrapper.innerHTML=t}},{name:["notification"],paint:function(e,t){if(!e.notifyEl)e.notifyEl=document.createElement("div"),e.helper.addPartClasses("notify",e.notifyEl),e.main.appendChild(e.notifyEl);if(t){if(t>e.max)t=e.max+"+";e.notifyEl.innerHTML=t,e.notifyEl.style.display="block"}else e.notifyEl.innerHTML=0,e.notifyEl.style.display="none"}}),updateNotify:function(e){this.set("notification",e-0)}},t.inherits(e,i),require("esui/main").register(e),e});