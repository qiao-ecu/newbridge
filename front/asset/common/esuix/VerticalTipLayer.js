define(function(require){function e(){i.apply(this,arguments)}var t=require("underscore"),n=require("esui/lib"),i=require("esui/TipLayer"),r=require("esui/controlHelper");return e.prototype.type="VerticalTipLayer",e.prototype.autoPosition=function(e,i){var a=this,o=this.main;i=i||{left:"right",top:"top"},i.positionOpt=t.extend({offsetLeft:0,offsetTop:0},i.positionOpt);var s=e.getBoundingClientRect(),l=n.getOffset(e),u={top:s.top,right:s.right,bottom:s.bottom,left:s.left,width:s.right-s.left,height:s.bottom-s.top},d=o.style.display;o.style.display="block";var c=o.offsetHeight,f=o.offsetWidth;o.style.display="none";var h=n.clone(i),p=n.page.getViewWidth(),m=n.page.getViewHeight(),g=u.right-u.width-f,v=p-u.left-f,y=m-u.bottom-c,_=u.top-c;if(v>=0)if(g>=0){if(!h.right&&!h.left)if(g>v)h.left=null,h.right="right";else h.left="left",h.right=null}else h.left="left",h.right=null;else h.left=null,h.right="right";if(y>=0)if(y>=0){if(!h.bottom&&!h.top)if(y>_)h.top="bottom",h.bottom=null;else h.top=null,h.bottom="top"}else h.top="bottom",h.bottom=null;else h.top=null,h.bottom="top";var b,w={};if(h.right)if(w.left=l.right-f+i.positionOpt.offsetLeft,h.top)b="rt";else b="rb";else if(h.left)if(w.left=l.left+i.positionOpt.offsetLeft,h.top)b="lt";else b="lb";if(h.top)w.top=l.bottom+i.positionOpt.offsetTop;else if(h.bottom)w.top=l.top-c+i.positionOpt.offsetTop;o.style.display=d,o.className=""+r.getPartClasses(a).join(" ")+" "+r.getPartClasses(a,b).join(" ");var x=n.g(r.getId(a,"arrow"));if(x)x.className=""+r.getPartClasses(a,"arrow").join(" ")+" "+r.getPartClasses(a,"arrow-"+b).join(" ");a.renderLayer(o,w)},n.inherits(e,i),require("esui/main").register(e),e});