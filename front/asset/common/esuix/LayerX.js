define(function(require){function e(){n.apply(this,arguments)}function t(e,t){var n=i.clone(t||{});if(n.hasOwnProperty("top")&&n.hasOwnProperty("bottom"))n.height=n.bottom-n.top,delete n.bottom;if(n.hasOwnProperty("left")&&n.hasOwnProperty("right"))n.width=n.right-n.left,delete n.right;if(n.hasOwnProperty("top")||n.hasOwnProperty("bottom"))e.style.top="",e.style.bottom="";if(n.hasOwnProperty("left")||n.hasOwnProperty("right"))e.style.left="",e.style.right="";for(var r in n)if(n.hasOwnProperty(r))e.style[r]=n[r]+"px"}var n=require("esui/Layer"),i=require("esui/lib");return i.inherits(e,n),n.attachTo=function(e,n,r){r=r||{strictWidth:!1};var a=i.page.getViewWidth(),o=i.page.getViewHeight(),s=i.page.getScrollTop(),l=i.page.getScrollLeft(),u=i.getOffset(n),d=e.style.display;if(e.style.display="block",e.style.top="-5000px",e.style.left="-5000px",r.strictWidth)e.style.minWidth=u.width+"px";if(r.width)e.style.width=!isNaN(parseInt(r.width,10))?parseInt(r.width,10)+"px":u.width+"px";var f=i.getOffset(e);e.style.top="",e.style.left="",e.style.display=d;var c={};if(r.direction){if("up"===r.direction.vertical)c.top=u.top-f.height;else c.top=u.bottom;if("left"===r.direction.horizon)c.left=u.left;else c.left=u.right-f.width}else{var p=o-(u.bottom-s),h=u.top-s;if(p<=f.height&&h>f.height)c.top=u.top-f.height;else c.top=u.bottom;var m=a-(u.left-l),g=u.right-l;if(m<=f.width&&g>f.width)c.left=u.right-f.width;else c.left=u.left}t(e,c)},n.centerToView=function(e,t){var n=t?i.clone(t):{};if("number"!=typeof n.width)n.width=this.width;if("number"!=typeof n.height)n.height=this.height;n.left=(i.page.getViewWidth()-n.width)/2;var r=i.page.getViewHeight();if(n.height>=r&&t.hasOwnProperty("minTop"))n.top=t.minTop;else n.top=Math.floor((r-n.height)/2);var a=i.page.getViewWidth();if(n.height>=a&&t.hasOwnProperty("minLeft"))n.left=t.minLeft;else n.left=Math.floor((a-n.width)/2);n.top+=i.page.getScrollTop(),this.setProperties(n)},e});