define(function(require){var exports={},e={rootPath:"test/test/.git"},t=window.require,n=require("jquery"),i=require("./git-fs");t("path"),t("mkdirp"),t("fs"),process.cwd(),t("js-git/lib/modes");return t("js-git/mixins/fs-db")(e,i),t("js-git/mixins/create-tree")(e),t("js-git/mixins/pack-ops")(e),t("js-git/mixins/read-combiner")(e),t("js-git/mixins/formats")(e),require("./walker")(e),exports.fetch=function(){var i=n.Deferred(),r=t("js-git/net/git-fetch-pack"),a=t("js-git/net/request-xhr"),o=t("js-git/net/transport-http")(a),s=o("https://github.com/li-yinan/test.git"),l=r(s),u={};return l.take(function(t,n){if(t)throw t;for(var i in n)if(n.hasOwnProperty(i)&&/^refs/.test(i))u[i.replace("heads","remotes/origin")]=n[i],l.put({want:n[i]});l.put(null),e.readPackedRefs(function(e,t){for(var n in u)if(n in t)l.put({have:t[n]});l.put({done:!0})})}),l.take(function(t,n){if(t)throw t;e.unpack(n.pack,{onProgress:function(t){var n=/\((\d+)\/(\d+)\)/,r=n.exec(t);if(console.log(t),r[1]==r[2]-1)t="Receiving objects: 100% ("+r[2]+"/"+r[2]+")\r\n",console.log(t),e.updateRefs(u,function(){i.resolve(u)})},onError:function(e){console.log(e),i.reject(e)}},function(){i.resolve()})}),i.promise()},exports.checkout=function(t,i){var r=n.Deferred();return e.getBranch(function(n,a){t=t||"refs/heads/"+a,i=i||"refs/remotes/origin/"+a,console.log('checkout from "'+t+'" to "'+i+'"'),e.checkout(t,i).then(function(){r.resolve()})}),r.promise()},exports.getLastCommit=function(){var t=n.Deferred();return e.getBranch(function(n,i){var r="refs/remotes/origin/"+i;e.resolveHash(r).then(e.loadCommit).then(function(e){t.resolve(e)})}),t.promise()},exports});