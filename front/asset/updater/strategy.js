define(function(require){function e(e){var t=e.message,n=/\[(.+?)(:?\s+(.+))*\]/g.exec(t);if(n)return{cmd:n[1],param:n[3]};else return void 0}function t(){return n.getLastCommit().then(function(t){var n=e(t);if(n&&i[n.cmd])return console.log("执行command "+n.cmd),i[n.cmd](n.param);else console.log("没有命令，不升级")})}var n=require("./git"),i=(require("jquery"),{});return i.update=function(){return console.log("升级"),n.checkout()},i.filter=function(e){var t=e.split(":"),n=t[0],r=t[1];if(process.env[n]===r)return console.log("准备升级"),i.update();else console.log("未升级")},i.revert=function(e){return console.log("回滚至"+e),n.checkout("HEAD",e)},{run:t}});