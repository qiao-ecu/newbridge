define(function(require){function e(e){var t=a.dateFormat(new Date,"yyyy-MM-dd HH:mm:ss");console.log("正在获取更新 "+t),n.fetch().then(function(e){if(e)console.log("更新下载成功"),exports.updated({updated:!0});else console.log("无更新"),exports.updated({updated:!1})})}var exports={},t=window.require,n=require("./git"),i=require("./strategy"),r=t(process.cwd()+"/package.json"),a=require("common/util/util");return exports.init=function(e){if(r.autoupdate)i.run().then(e);else e()},exports.update=function(){if(r.autoupdate){var t=r.updateDuration||6e5;e(),setInterval(e,t)}else console.log("配置文件未启用升级")},exports.updated=function(e){if(e.updated)exports.showUpdateNotify({data:{body:"更新已下载，点击重启安装更新"},title:"系统更新",click:function(){}})},exports.showUpdateNotify=function(){},exports});