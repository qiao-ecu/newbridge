define(function(require,exports,module){function e(){t.apply(this,arguments),this.icons=[]}var t=require("ef/UIView"),n=require("er/util"),i=require("underscore"),r=require("esui"),a=require("common/util/globalData");return require("tpl!./main.tpl"),require("common/esuix/Icon"),require("common/esuix/VerticalTipLayer"),e.prototype.template="iconMenu",e.prototype.uiProperties={icon:{max:10}},e.prototype.uiEvents={"icon:click":function(){var e=this.get("icon");setInterval(function(){e.updateNotify(e.notification-0+1)},1e3)}},e.prototype.addIcons=function(e){this.icons=this.icons.concat(e),this.icons.sort(function(e,t){return e.priority-t.priority}),this.renderIcons(this.icons)},e.prototype.renderIcons=function(e){var t=this.getContainerElement(),n=t.getElementsByClassName("icon-menu")[0];i.map(e,function(e){e.appendTo(n)})},e.prototype.initQrCode=function(){var e=r.create("VerticalTipLayer",{width:420,height:350,title:"欢迎使用移动商桥",content:'<div data-ui="type:DualCachedPanel;id:tip;url:/mobileQrcode"></div>'});e.appendTo(document.body),e.render(),e.attachTo({targetControl:"mobileIcon",showMode:"click",positionOpt:{top:"bottom",right:"right"}})},e.prototype.enterDocument=function(){t.prototype.enterDocument.call(this,arguments);var e=a.get("domain"),n=a.get("token"),i=r.create("Icon",{className:"icon-menu-settings-icon",disabled:!0,content:"系统设置"}),o=r.create("Icon",{id:"mobileIcon",className:"icon-menu-mobile-icon",disabled:!1,content:"移动商桥"}),s=r.create("Icon",{id:"leaveMessage",className:"icon-menu-leave-message-icon",disabled:!1,windowWidth:980,windowHeight:600,content:"留言管理",priority:10,url:"http://"+e+"/bookmanage/initBook.action?token="+n}),l=r.create("Icon",{id:"report",className:"icon-menu-report-icon",disabled:!1,content:"数据统计",windowWidth:980,windowHeight:600,priority:11,url:"http://"+e+"/report/reportIndex.action?token="+n});this.addIcons([i,o,s,l]),this.initQrCode()},n.inherits(e,t),e});