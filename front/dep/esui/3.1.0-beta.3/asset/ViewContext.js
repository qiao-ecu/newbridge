define(function(require){function e(e){o.apply(this,arguments),this.name=e}function t(e,t){o.prototype.add.call(t,e)}function i(e,t){o.prototype.remove.call(t,e)}function n(e){var t=e.get("group");return t?t.split(/[\t\r\n ]/):[]}function r(){return"vt"+s++}function a(e){if(this.controls={},this.groups={},e=e||r(),l.hasOwnProperty(e)){for(var t=1,i=e+"-";l.hasOwnProperty(i+t);)t++;e=i+t}this.id=e,l[this.id]=this}var o=require("./ControlCollection");require("./lib").inherits(e,o),e.prototype.add=void 0,e.prototype.remove=void 0,e.prototype.disposeGroup=function(){for(var e=0;e<this.length;e++)delete this[e];this.length=0};var s=8587523,l={};a.get=function(e){return l[e]||null},a.prototype.add=function(e){var i=this.controls[e.id];if(i){if(i===e)return;i.setViewContext(null)}this.controls[e.id]=e;for(var r=n(e),a=0;a<r.length;a++){var o=r[a];if(o){var s=this.getGroup(o);t(e,s)}else;}e.setViewContext(this)},a.prototype.remove=function(e){delete this.controls[e.id];for(var t=n(e),r=0;r<t.length;r++){var a=t[r];if(a){var o=this.getGroup(a);i(e,o)}else;}e.setViewContext(null)},a.prototype.get=function(e){return this.controls[e]};var d=require("./SafeWrapper");return a.prototype.getSafely=function(e){var t=this.get(e);if(!t)t=new d,t.id=e,t.viewContext=this;return t},a.prototype.getGroup=function(t){if(!t)throw new Error("name is unspecified");var i=this.groups[t];if(!i)i=this.groups[t]=new e(t);return i},a.prototype.clean=function(){for(var e in this.controls)if(this.controls.hasOwnProperty(e)){var t=this.controls[e];if(t.dispose(),t.viewContext&&t.viewContext===this)this.remove(t)}for(var i in this.groups)if(this.groups.hasOwnProperty(i))this.groups[i].disposeGroup(),this.groups[i]=void 0},a.prototype.dispose=function(){this.clean(),delete l[this.id]},a});