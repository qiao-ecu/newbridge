define(function(require){function e(){i.apply(this,arguments)}var t=require("underscore"),n=require("./lib"),i=require("./Control");e.defaultProperties={separator:">"},e.prototype.type="Crumb",e.prototype.initOptions=function(i){var r={path:[]};t.extend(r,e.defaultProperties,i);var o=n.getChildren(this.main);if(!i.path&&o.length)r.path=t.map(o,function(e){var t={text:n.getText(e)};if("a"===e.nodeName.toLowerCase())t.href=n.getAttribute(e,"href");return t});this.setProperties(r)},e.prototype.textNodeTemplate='<span class="${classes}">${text}</span>',e.prototype.linkNodeTemplate='<a class="${classes}" href="${href}">${text}</a>',e.prototype.separatorTemplate='<span class="${classes}">${text}</span>',e.prototype.getNodeHTML=function(e,i){var r=this.helper.getPartClasses("node");if(0===i)r.push.apply(r,this.helper.getPartClasses("node-first"));if(i===this.path.length-1)r.push.apply(r,this.helper.getPartClasses("node-last"));var o=e.href?this.linkNodeTemplate:this.textNodeTemplate,a={href:t.escape(e.href),text:t.escape(e.text),classes:r.join(" ")};return n.format(o,a)},e.prototype.getSeparatorHTML=function(){return n.format(this.separatorTemplate,{classes:this.helper.getPartClassName("separator"),text:t.escape(this.separator)})};var r=require("./painters");return e.prototype.repaint=r.createRepaint(i.prototype.repaint,{name:["path","separator"],paint:function(e,n){var i=t.map(n,e.getNodeHTML,e),r=e.getSeparatorHTML();e.main.innerHTML=i.join(r)}}),require("./main").register(e),n.inherits(e,i),e});