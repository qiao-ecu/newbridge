define(function(require){var exports={},e=require("im-lib/lang/each"),t=window;document;return exports.setRange=function(e){var i=exports.getRange();i.setStartBefore(e),i.collapse(!0);var n=t.getSelection();n.removeAllRanges(),n.addRange(i)},exports.getRange=function(e){var i=t.getSelection(),n=i.getRangeAt(0);return n},exports.insertNodes=function(i,n,r,a){i.focus();var o=t.getSelection();if(!a)a=o.getRangeAt(0);if(a.deleteContents(),n.reverse(),e(n,function(e){a.insertNode(e)}),!r)a=document.createRange(),a.setStartAfter(n[0]),a.collapse(!0),o.removeAllRanges(),o.addRange(a)},exports});