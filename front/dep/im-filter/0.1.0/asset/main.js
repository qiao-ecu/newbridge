define(function(require){function e(t,i,n){i=i||{};for(var r=t.childNodes,a=0;a<r.length;a++){var o=r[a].tagName;if(!(o in i))if(3===r[a].nodeType)n(r[a]);else e(r[a],i,n);else if("function"==typeof i[o])i[o](r[a])}}function t(t){var i=document.createElement("div");i.innerHTML=t;var n=/([\w\:\\\/@]+\.[\w\&#\?=\:\\\/\.]+)/g;return e(i,{A:function(e){e.setAttribute("target","_blank")}},function(e){var t=!1,i=e.data,r=i.replace(n,function(e){if(e.indexOf("@")>0)return e;if(t=!0,/https?\:\/\//.test(e))return'<a href="'+e+'" target="_blank">'+e+"</a>";else return'<a href="http://'+e+'" target="_blank">'+e+"</a>"});if(t){var a=document.createElement("span");a.innerHTML=r;var o=e.parentNode;o.insertBefore(a,e),o.removeChild(e)}}),i.innerHTML}function i(e){return e.replace(a,"").replace(o,"")}var n="http://s.goutong.baidu.com/webim/resource/img/loading.gif",r="http://s.goutong.baidu.com/webim/resource/img/fail.png",a=/<script.*?>.*?<\/script>/g,o=/ on\w+=(['"]).*\1/g;return{staticHTMLFilter:i,loadingUrl:n,loadFailUrl:r,anchor:t}});