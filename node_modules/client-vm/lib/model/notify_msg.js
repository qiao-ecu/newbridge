function NotifyMmessage(e,t){this.name=e;var n=Array.prototype.slice.call(arguments,0);ViewModelClass.call(this,n),dataFactory().on(consts.EVENT_NOTIFY_MESSAGE,function(e){var t={name:singtonNogityMsg.name,subViewName:"bookInitCnt",dynamicViewName:"bookInitCnt",mode:"external",value:e};singtonNogityMsg.emit("data",t)}),dataFactory().once(consts.EVENT_NOTIFY_MESSAGE,function(e){var t={name:singtonNogityMsg.name,subViewName:"bookInitCnt",dynamicViewName:"bookInitCnt",mode:"external",value:e,id:0};ViewModelClass.silenceSave(singtonNogityMsg,"bookInitCnt",t)}),dataFactory().send(consts.COMMAND_DATACHANNEL_SYNC_START,{viewName:"vm:notify",subViewName:"bookInitCnt",data:[]})}function messageLoader(e,t,n,i){}var Emitter=require("events").EventEmitter,inherits=require("util").inherits,Q=require("q"),DB=require("nedb"),path=require("path"),ViewModelClass=require("../ViewModel"),blinkFactory=require("../BlinkChannel"),dataFactory=require("../DataChannel"),consts=require("../utils/const"),extend=require("../utils/extend"),fastGet=require("../utils/pulldata").fastGet,log=require("../utils/log")("settings");inherits(NotifyMmessage,ViewModelClass),NotifyMmessage.prototype._filterSubViewData=function(e,t,n,i,o){var s=Q.defer(),r=[];if(!e.get(0))dataFactory().send(consts.COMMAND_DATACHANNEL_SYNC_START,{viewName:"vm:notify",subViewName:"bookInitCnt",data:[]});else r.push(e.get(0).value);return s.resolve(r),s.promise};var singtonNogityMsg;module.exports=function(e){if(singtonNogityMsg)return singtonNogityMsg;else return singtonNogityMsg=new NotifyMmessage("vm:notify",e||{}),log.info("Created a visitor view model instance with %s, and keep it only one.",JSON.stringify(e)),log.info("Starting to create sub-view and dynamic-view on %s.",singtonNogityMsg.name),singtonNogityMsg.createSubView("bookInitCnt",messageLoader),log.info("Starting to create sub-view and dynamic-view on %s.",singtonNogityMsg.name),singtonNogityMsg.createDynamicView("bookInitCnt","bookInitCnt",{}),singtonNogityMsg};